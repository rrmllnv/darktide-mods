# scoreboard_history.lua - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–§–∞–π–ª —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∏—Å—Å–∏–π –≤ —Ñ–∞–π–ª—ã –∏ –∏—Ö –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏.

## –ü—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### `mod.appdata_path()`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `%APPDATA%/Fatshark/Darktide/scoreboard_history/`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ñ–∞–π–ª–∞–º–∏ –∏—Å—Ç–æ—Ä–∏–∏.

---

### `mod.create_scoreboard_history_directory()`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ —á–µ—Ä–µ–∑ `isdir()`
- –ï—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ—Ç —á–µ—Ä–µ–∑ `_os.execute('mkdir ...')`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ñ–∞–π–ª–∞.

---

### `mod.create_scoreboard_history_entry_path()`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–µ—Ç –ø—É—Ç—å –∏ –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `file_path` - –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `file_name` - –ò–º—è —Ñ–∞–π–ª–∞ (Unix timestamp + ".lua")

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É —á–µ—Ä–µ–∑ `current_date()` (Unix timestamp)
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞: `{timestamp}.lua`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∏ –∏–º—è —Ñ–∞–π–ª–∞

---

## –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

### `mod.save_scoreboard_history_entry(sorted_rows)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏—Å—Å–∏–∏ –≤ —Ñ–∞–π–ª.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `sorted_rows` - –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏:**
   - –í—ã–∑—ã–≤–∞–µ—Ç `create_scoreboard_history_directory()`

2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞:**
   - –ü–æ–ª—É—á–∞–µ—Ç –ø—É—Ç—å –∏ –∏–º—è —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ `create_scoreboard_history_entry_path()`
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏

3. **–ó–∞–ø–∏—Å—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∏—Å—Å–∏–∏:**
   - –§–æ—Ä–º–∞—Ç: `#mission;{name};{challenge};{circumstance};{victory_defeat};{timer}\n`
   - `timer` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–∏—Å—Å–∏–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è - –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞)

4. **–ó–∞–ø–∏—Å—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–≥—Ä–æ–∫–∞—Ö:**
   - –§–æ—Ä–º–∞—Ç: `#players;{count}\n`
   - –ó–∞—Ç–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞: `{index};{account_id};{name};{symbol}\n`
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–æ 4 –∏–≥—Ä–æ–∫–æ–≤

5. **–ó–∞–ø–∏—Å—å —Å—Ç—Ä–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
   - –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ (–∫—Ä–æ–º–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ —Å—Ç—Ä–æ–∫ —Å –æ—á–∫–∞–º–∏):
     - –§–æ—Ä–º–∞—Ç: `#row;{name};{index};{val_count};{text};{validation};{iteration};{visible};{group};{setting};{parent};{is_time};{summary};{normalize};{icon};{icon_package};{icon_width}\n`
     - –ó–∞—Ç–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞: `{account_id};{score};{is_best};{is_worst};{text}\n`
   - –î–ª—è —Å—Ç—Ä–æ–∫ —Å –æ—á–∫–∞–º–∏ (–≥—Ä—É–ø–ø):
     - –§–æ—Ä–º–∞—Ç: `#group;{name};{text}\n`

6. **–ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞:**
   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª
   - –î–æ–±–∞–≤–ª—è–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –≤ –∫—ç—à

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –º–∏—Å—Å–∏–∏ –∏–ª–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.

---

## –ó–∞–≥—Ä—É–∑–∫–∞

### `mod.get_scoreboard_history_entries(scan_dir)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `scan_dir` - –§–ª–∞–≥ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –∑–∞–ø–∏—Å–µ–π

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤:**
   - –ï—Å–ª–∏ –µ—Å—Ç—å –∫—ç—à –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à
   - –ò–Ω–∞—á–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ `scandir()`
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ø–∏—Å–æ–∫ –≤ –∫—ç—à

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π:**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
     - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∑–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ `load_scoreboard_history_entry()` —Å —Ñ–ª–∞–≥–æ–º `only_head = true`
     - –î–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
       - `file` - –ò–º—è —Ñ–∞–π–ª–∞
       - `file_path` - –ü–æ–ª–Ω—ã–π –ø—É—Ç—å
       - `date` - –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∞—Ç–∞

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤:**
   - –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä—É–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ view –∏—Å—Ç–æ—Ä–∏–∏.

---

### `mod.load_scoreboard_history_entry(path, date, only_head)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –æ–¥–Ω—É –∑–∞–ø–∏—Å—å –∏–∑ —Ñ–∞–π–ª–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` - –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `date` - –î–∞—Ç–∞ (Unix timestamp) –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- `only_head` - –ó–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∏—Å—Å–∏–∏ –∏ –∏–≥—Ä–æ–∫–∞—Ö)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `entry` - –û–±—ä–µ–∫—Ç –∑–∞–ø–∏—Å–∏
- `groups` - –¢–∞–±–ª–∏—Ü–∞ –≥—Ä—É–ø–ø –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–∏:**
   - –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª—è–º–∏ `name` –∏ `date`

2. **–ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞:**
   - –ß–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Å—Ç—Ä–æ–∫–∏ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É:
     - `#mission` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∏—Å—Å–∏–∏
     - `#players` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–æ–∫–∞—Ö
     - `#row` - –°—Ç—Ä–æ–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
     - `#group` - –ì—Ä—É–ø–ø–∞ (—Å—Ç—Ä–æ–∫–∞ —Å –æ—á–∫–∞–º–∏)

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∏—Å—Å–∏–∏:**
   - –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É `#mission`
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç: `mission_name`, `mission_challenge`, `mission_circumstance`, `victory_defeat`, `timer`
   - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç `timer` –≤ —Ñ–æ—Ä–º–∞—Ç `HH:MM:SS`

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–≥—Ä–æ–∫–æ–≤:**
   - –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É `#players` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
   - –ß–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `entry.players[index]`:
     - `account_id`
     - `name`
     - `string_symbol`

5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫ (–µ—Å–ª–∏ `only_head = false`):**
   - –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É `#row` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∏
   - –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å—Ç—Ä–æ–∫–∏ —Å–æ –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏
   - –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `entry.rows[index].data[account_id]`:
     - `score`
     - `value`
     - `text_data` (–µ—Å–ª–∏ –µ—Å—Ç—å)

6. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø:**
   - –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É `#group`
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É `groups` –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ view –∏—Å—Ç–æ—Ä–∏–∏.

---

## –£–¥–∞–ª–µ–Ω–∏–µ

### `mod.delete_scoreboard_history_entry(file_name)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–¥–∞–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `file_name` - –ò–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `true`, –µ—Å–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
3. –£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª —á–µ—Ä–µ–∑ `_os.remove()`
4. –£–¥–∞–ª—è–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ –∫—ç—à–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π –∏–∑ view –∏—Å—Ç–æ—Ä–∏–∏.

---

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### `mod.get_scoreboard_history_entries_cache()`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –∫—ç—à —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ú–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ `nil`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ë—ã—Å—Ç—Ä–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±–µ–∑ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

---

### `mod.set_scoreboard_history_entries_cache(entries)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫—ç—à —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `entries` - –ú–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `mod.current_date()`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –∫–∞–∫ Unix timestamp.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** Unix timestamp —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.

---

### `exists(file)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `file` - –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `true`, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤ —Å–∞–º–æ–≥–æ —Å–µ–±—è
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "Permission denied" (–∫–æ–¥ 13), —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

---

### `isdir(path)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—É—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` - –ü—É—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `true`, –µ—Å–ª–∏ —ç—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ `path + "/"`

---

### `file_exists(name)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `name` - –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `true`, –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –¥–ª—è —á—Ç–µ–Ω–∏—è
- –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true`

---

### `scandir(directory)`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∫–∞–Ω–∏—Ä—É–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `directory` - –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ú–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–∞–Ω–¥—É `dir` —á–µ—Ä–µ–∑ `_io.popen()`
- –ß–∏—Ç–∞–µ—Ç –≤—ã–≤–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

---

## –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
#mission;{name};{challenge};{circumstance};{victory_defeat};{timer}
#players;{count}
{index};{account_id};{name};{symbol}
...
#row;{name};{index};{val_count};{text};{validation};{iteration};{visible};{group};{setting};{parent};{is_time};{summary};{normalize};{icon};{icon_package};{icon_width}
{account_id};{score};{is_best};{is_worst};{text}
...
#group;{name};{text}
...
```

### –ü—Ä–∏–º–µ—Ä

```
#mission;MissionName;;;victory;3600
#players;4
1;account1;Player1;‚ö°
2;account2;Player2;üî™
3;account3;Player3;üõ°Ô∏è
4;account4;Player4;üî•
#row;damage_dealt;1;4;Damage Dealt;ASC;ADD;nil;offense;plugin_damage_dealt < 3;nil;nil;nil;nil;nil;nil;nil
account1;15000;1;0;
account2;12000;0;0;
account3;18000;0;1;
account4;16000;0;0;
```

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- DMF - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π —á–µ—Ä–µ–∑ `_os` –∏ `_io`
- `mod.player_manager` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
- `mod.timer` - –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –º–∏—Å—Å–∏–∏
- `mod.mission_name`, `mod.mission_challenge`, `mod.mission_circumstance`, `mod.victory_defeat` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∏—Å—Å–∏–∏

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```lua
mod:save_scoreboard_history_entry(sorted_rows)
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π

```lua
local entries = mod:get_scoreboard_history_entries()
for _, entry in pairs(entries) do
    mod:echo(entry.date .. " - " .. entry.mission_name)
end
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```lua
local entry, groups = mod:load_scoreboard_history_entry(file_path, date, false)
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```lua
mod:delete_scoreboard_history_entry("1234567890.lua")
```
