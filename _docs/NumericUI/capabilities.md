# NumericUI - Полное описание возможностей

## Общее описание
NumericUI - мод для Warhammer 40,000: Darktide, который добавляет числовые значения в интерфейс игры. Мод разработан автором raindish и расширяет стандартный HUD дополнительной информацией в виде цифр.

---

## 1. ИНТЕРФЕЙС КОМАНДЫ (Team HUD)

### 1.1 Здоровье и стойкость
- **health_text** - Показывает числовое значение здоровья каждого игрока команды
- **toughness_text** - Показывает числовое значение стойкости каждого игрока команды
- **level** - Показывает уровень игрока в команде

### 1.2 Боеприпасы команды
- **ammo_text** - Показывает количество боеприпасов у каждого игрока команды
- **peril_text** - Показывает процент опасности (Peril) для Псайкера
- **peril_icon** - Показывает иконку опасности для Псайкера
- **ammo_as_percent** - Отображает боеприпасы в процентах вместо абсолютных значений

#### Что такое Peril (Опасность)?
**Peril** (также называемый **Warp Charge** - Заряд Варпа) - это уникальная механика для класса **Псайкер** в Warhammer 40,000: Darktide.

**Как работает:**
- При использовании псионических способностей (силовые посохи, способности) накапливается Peril
- Значение отображается в процентах от 0% до 100%
- При достижении критического уровня (97-100%) Псайкер может взорваться, получив урон
- Peril автоматически снижается со временем (автоматическое вентилирование через 3 секунды бездействия)
- Можно вручную вентилировать Peril, чтобы снизить его уровень

**Отображение в моде:**
- **peril_icon** - Показывает специальную иконку (символ "") рядом с панелью игрока-Псайкера
  - Иконка меняет цвет в зависимости от уровня опасности:
    - **> 98%** - Красный цвет (критический уровень, высокий риск взрыва)
    - **> 75%** - Оранжевый/желтый цвет (высокий уровень)
    - **> 50%** - Желтый цвет (средний уровень)
    - **≤ 50%** - Обычный цвет (низкий уровень)
  
- **peril_text** - Показывает точный процент опасности в виде текста (например, "87%")
  - Отображается вместо текста боеприпасов, если у Псайкера нет оружия с боеприпасами
  - Цвет текста также меняется в зависимости от уровня опасности

**Важно:**
- Эти опции работают **только для игроков-Псайкеров** (автоматически определяется архетип)
- Если у Псайкера есть оружие с боеприпасами, то `peril_text` не отображается (показываются боеприпасы)
- Иконка и текст помогают отслеживать уровень опасности и избегать взрыва

### 1.3 Способности команды
- **ability_cd_bar** - Показывает время перезарядки способности в виде прогресс-бара
- **ability_cd_text** - Показывает время перезарядки способности в виде числового счетчика (формат: 000)

---

## 2. СЧЕТЧИК УКЛОНЕНИЙ (Dodge Count HUD)

### 2.1 Основные настройки
- **dodge_count** - Показывает количество доступных уклонений
- **dodges_count_up** - Счетчик уклонений увеличивается (показывает сколько уклонений использовано)
- **show_efficient_dodges** - Показывает количество эффективных уклонений в формате X/Y
- **fade_out_max_dodges** - Скрывает счетчик при максимальном количестве уклонений (затухание)
- **show_dodge_count_for_infinite_dodge** - Показывает счетчик для оружия с бесконечными уклонениями
- **debug_dodge_count** - Показывает отладочную информацию об уклонениях

### 2.2 Таймер сброса уклонений (Dodge Count Reset Timer HUD)
- **dodge_timer** - Показывает таймер сброса счетчика уклонений в виде прогресс-бара
- **color_start** - Цвет таймера в начале (по умолчанию: UI Orange Light)
- **color_end** - Цвет таймера в конце (по умолчанию: UI Red Light)
- **dodge_timer_y_offset** - Вертикальное смещение таймера (по умолчанию: 30, диапазон: -50 до 50)
- **dodge_timer_width** - Ширина таймера (по умолчанию: 208, диапазон: 0 до 500)
- **dodge_timer_height** - Высота таймера (по умолчанию: 9, диапазон: 0 до 20)
- **dodge_timer_hide_full** - Скрывать таймер когда уклонения полностью восстановлены

**Особенности:**
- Таймер показывает время до восстановления уклонений
- Цвет плавно переходит от начального к конечному
- Таймер скрывается когда уклонения на максимуме (если включена опция)

---

## 3. ИНТЕРФЕЙС БОЕПРИПАСОВ ИГРОКА (Ammo HUD)

### 3.1 Отображение боеприпасов
- **max_ammo_text** - Показывает максимальное количество боеприпасов
- **show_ammo_icon** - Показывает иконку боеприпасов рядом с числом
- **show_max_ammo_as_percent** - Показывает максимальные боеприпасы в процентах
- **ammo_text_font_size** - Размер шрифта текста боеприпасов (по умолчанию: 16, диапазон: 10-150)
- **ammo_text_offset_y** - Вертикальное смещение текста боеприпасов (по умолчанию: -16, диапазон: -500 до 500)
- **ammo_text_offset_x** - Горизонтальное смещение текста боеприпасов (по умолчанию: 80, диапазон: -500 до 500)

### 3.2 Получение боеприпасов
- **show_munitions_gained** - Показывает количество полученных боеприпасов и гранат
  - Анимация появления "+X" при получении боеприпасов
  - Отдельная анимация для гранат
  - Поддержка множественных виджетов для одновременного отображения нескольких приростов

### 3.3 Информация о патронах в контейнерах
- **show_ammo_amount_from_packs** - Показывает количество боеприпасов в патронных контейнерах и коробках
  - Отображает сколько боеприпасов будет получено при подборе
  - Показывает потери при переполнении (красным цветом)
  - Учитывает модификаторы Havoc режима

---

## 4. ИНТЕРФЕЙС СПОСОБНОСТЕЙ ИГРОКА (Ability Cooldown HUD)

### 4.1 Формат отображения
- **ability_cooldown_format** - Формат отображения перезарядки:
  - **"time"** (timer) - Таймер в секундах (по умолчанию)
  - **"percent"** - Процент готовности
  - **"none"** - Не показывать

### 4.2 Дополнительные настройки
- **disable_ability_background_progress** - Отключает визуальное увеличение шкалы способности на фоне
- **ability_cooldown_font_size** - Размер шрифта текста способности (по умолчанию: 30, диапазон: 20-50)

**Особенности:**
- Таймер показывает оставшееся время с точностью до 0.1 секунды при времени < 1 секунды
- При времени >= 1 секунды показывает целое число

---

## 5. ТАЙМЕР МИССИИ (Mission Timer)

- **show_mission_timer** - Показывает таймер миссии в формате MM:SS
- **mission_timer_in_overlay** - Показывать таймер только в тактическом оверлее (при удержании клавиши)

**Расположение:** Правый нижний угол экрана

---

## 6. ТАБЛИЧКИ С ИМЕНАМИ (Nameplates)

### 6.1 Иконки классов
- **archetype_icons_in_nameplates** - Использовать иконки классов в табличках с именами
- **color_nameplate** - Цвет текста таблички совпадает с цветом иконки класса

### 6.2 Таблички спутников (Companion Nameplates)
- **companion_nameplates_icon** - Показывать иконку спутника (электронного пса)
- **companion_nameplates_name** - Показывать имя спутника
- **companion_nameplates_screen_clamp** - Ограничивать таблички спутников границами экрана

---

## 7. РАЗМЕЩАЕМЫЕ ОБЪЕКТЫ (Pickups)

### 7.1 Медицинские контейнеры
- **show_medical_crate_radius** - Показывает радиус действия медицинского контейнера
  - Визуализирует зону лечения в виде декали на земле
  - **ВНИМАНИЕ:** Увеличивает использование памяти!

---

## 8. ЗДОРОВЬЕ БОССОВ (Boss Health)

- **show_boss_health_numbers** - Показывает числовые значения здоровья и стойкости боссов
  - Отображает текущее здоровье
  - Отображает текущую стойкость
  - Работает для одиночных и двойных целей

---

## 9. МАРКЕРЫ (Marker Settings)

### 9.1 Черепа пометок
- **show_ping_skull** - Показывать череп пометки над врагами
- **show_vet_ping_skull** - Показывать череп пометки Ветерана (от способности "Ciblage")
- **show_arb_ping_skull** - Показывать череп пометки Арбитров (Arbites)

---

## ТЕХНИЧЕСКИЕ ОСОБЕННОСТИ

### Архитектура мода
- Мод состоит из нескольких модулей, каждый отвечает за свою область:
  - `TeamPlayerPanel.lua` - Интерфейс команды
  - `PlayerAbility.lua` - Способности игрока
  - `PlayerWeapon.lua` - Оружие и боеприпасы игрока
  - `Interactions.lua` - Взаимодействия с объектами
  - `Nameplates.lua` - Таблички с именами
  - `MedicalCrate.lua` - Медицинские контейнеры
  - `BossHealth.lua` - Здоровье боссов
  - `PingMarkers.lua` - Маркеры пометок
  - `CompanionNameplates.lua` - Таблички спутников
  - `HudElementDodgeCount.lua` - Счетчик уклонений (кастомный HUD элемент)
  - `HudElementMissionTimer.lua` - Таймер миссии (кастомный HUD элемент)

### Система цветов
- Мод использует встроенную систему цветов игры
- Поддержка всех цветов из `Color.list`
- Динамическое изменение цветов в зависимости от состояния (например, цвет опасности Псайкера)

### Интеграция с игрой
- Мод перехватывает и модифицирует стандартные HUD элементы игры
- Использует систему хуков для расширения функциональности
- Автоматически пересоздает HUD при изменении настроек

### Производительность
- Большинство функций оптимизированы и не влияют на производительность
- Исключение: `show_medical_crate_radius` увеличивает использование памяти из-за загрузки дополнительных ресурсов

---

## НАСТРОЙКИ ПО УМОЛЧАНИЮ

Большинство функций включены по умолчанию:
- ✅ health_text
- ✅ toughness_text
- ✅ level
- ✅ ammo_text
- ✅ peril_text
- ✅ peril_icon
- ✅ ability_cd_bar
- ✅ ability_cd_text
- ✅ dodge_count
- ✅ show_efficient_dodges
- ✅ max_ammo_text
- ✅ show_ammo_icon
- ✅ show_munitions_gained
- ✅ show_ammo_amount_from_packs
- ✅ disable_ability_background_progress
- ✅ show_mission_timer
- ✅ mission_timer_in_overlay
- ✅ archetype_icons_in_nameplates
- ✅ companion_nameplates_icon
- ✅ companion_nameplates_name
- ✅ companion_nameplates_screen_clamp
- ✅ show_medical_crate_radius
- ✅ show_boss_health_numbers
- ✅ show_ping_skull
- ✅ show_vet_ping_skull
- ✅ show_arb_ping_skull

Выключены по умолчанию:
- ❌ dodges_count_up
- ❌ fade_out_max_dodges
- ❌ show_dodge_count_for_infinite_dodge
- ❌ debug_dodge_count
- ❌ dodge_timer
- ❌ ammo_as_percent
- ❌ show_max_ammo_as_percent
- ❌ color_nameplate
- ❌ dodge_timer_hide_full

---

## ПРИМЕЧАНИЯ

1. Мод полностью совместим с другими модами интерфейса
2. Все настройки можно изменять в реальном времени без перезапуска игры
3. Мод автоматически определяет архетип игрока (например, для отображения опасности Псайкера)
4. Поддерживается локализация на несколько языков (английский, русский, китайский, французский)
